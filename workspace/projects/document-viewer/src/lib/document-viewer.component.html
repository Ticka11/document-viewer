<div
  class="viewer-container"
  [ngStyle]="{ 'justify-content': totalPages > 1 ? 'space-between' : 'center' }"
  id="viewer-container"
>
  <div id="info-box">
    <div class="col-12 col-sm-12 p-0">
      <ng-template #orgDocInfo>
        <div class="sub-doc-info p-0">
          <div *ngIf="collapsStatus">
            {{ singleDocument?.file?.originalName }}
          </div>
          <span class="file-type-sub file-type">
            <span
              class="kat-sub-sent"
              *ngIf="
                singleDocument?.file?.sent && docModel.isModelContainerRjesenje
              "
            ></span>
            <span
              class="kat-sub-not-sent"
              *ngIf="
                !singleDocument?.file?.sent && docModel.isModelContainerRjesenje
              "
            ></span>
            <span class="sub-date">{{
              singleDocument?.file?.createdAt | date : "dd/MM/yy"
            }}</span>
          </span>
          <div class="sub-dco-type">
            {{ singleDocument?.file.type }}
          </div>
          <div class="mt-1">
            <div *ngFor="let sentance of singleDocument.file.toFix">
              <span class="mt-2"> {{ sentance }} </span>
            </div>
          </div>
        </div>
      </ng-template>
      <!-- merged docs -->

      <div
        class="model-info p-0 parent-ellipsis d-contents"
        *ngIf="singleDocument.originalMergedDocs"
      >
        <div ngbDropdown class="d-inline-block">
          <button
            type="button"
            class="btn btn-transparent border-0 btn-classic merged-btn"
            id="dropdownBasic1"
            ngbDropdownToggle
          >
            <span
              *ngIf="
                selectedFile !== undefined && checkSelectedDocs() === false
              "
              class="document-name"
              [ngClass]="
                selectedFile.file.filterValue ||
                activeFileId === selectedFile.file._id
                  ? 'active-filter'
                  : 'inactive-filter'
              "
            >
              <div
                class="underlined"
                [ngStyle]="{
                  'border-bottom':
                    selectedFile.colorValue === openedDocColor
                      ? '4px solid ' + selectedFile.colorValue
                      : '4px solid ' + selectedFile.colorValue + '54'
                }"
              >
                {{ selectedFile?.file?.originalName | stringEllipsis : 15 }}
              </div>
            </span>

            <span
              *ngIf="
                checkSelectedDocs() === false && selectedFile === undefined
              "
              >Merged documents</span
            >
            <span *ngIf="checkSelectedDocs() === true"
              >Multiple selected documents</span
            >
          </button>
          <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
            <button
              ngbDropdownItem
              class="px-1"
              [ngbTooltip]="singleDocInfo"
              *ngFor="
                let doc of singleDocument.originalMergedDocs;
                last as isLast
              "
            >
              <input
                class="form-check-input inp-cbx"
                type="checkbox"
                name="document"
                [id]="'defaultCheck' + doc.file._id"
                [(ngModel)]="doc.file.filterValue"
                (ngModelChange)="filterPattern($event, doc)"
              />
              <label
                class="cbx m-0 d-flex align-items-center"
                [ngClass]="
                  doc.file.filterValue || activeFileId === doc.file._id
                    ? 'active-filter'
                    : 'inactive-filter'
                "
                [for]="'defaultCheck' + doc.file._id"
                ><span class="mx-2">
                  <svg width="12px" height="10px">
                    <use xlink:href="#check"></use></svg
                ></span>
                <span class="document-name">
                  <div
                    class="underlined"
                    [ngStyle]="{
                      'border-bottom':
                        doc.colorValue === openedDocColor
                          ? '4px solid ' + doc.colorValue
                          : '4px solid ' + doc.colorValue + '54'
                    }"
                  >
                    {{ doc?.file?.originalName | stringEllipsis : 20 }}
                  </div>
                </span>
              </label>
              <svg class="inline-svg mr-1">
                <symbol id="check" viewbox="0 0 12 10">
                  <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                </symbol>
              </svg>
              <!-- tooltip template -->
              <ng-template #singleDocInfo>
                <div class="sub-doc-info">
                  <div *ngIf="collapsStatus">
                    {{ doc?.file?.originalName }}
                  </div>
                  <span class="file-type-sub file-type">
                    <span
                      class="kat-sub-sent"
                      *ngIf="
                        doc?.file?.sent && docModel.isModelContainerRjesenje
                      "
                    ></span>
                    <span
                      class="kat-sub-not-sent"
                      *ngIf="
                        !doc?.file?.sent && docModel.isModelContainerRjesenje
                      "
                    ></span>
                    <span class="sub-date">{{
                      doc?.file?.createdAt | date : "dd/MM/yy"
                    }}</span>
                  </span>
                  <div class="sub-dco-type">
                    {{ doc?.file.type }}
                  </div>
                </div>
              </ng-template>
            </button>
          </div>
        </div>
      </div>

      <!-- end of merged  -->
      <div class="model-info p-0 parent-ellipsis" [ngbTooltip]="orgDocInfo">
        <p
          *ngIf="!singleDocument.mergedDocs"
          [ngClass]="{
            'red-flag': documentConfig?.flag == 'red',
            'green-flag': documentConfig?.flag == 'green'
          }"
          class="traning-model-name text-ellipsis"
          (click)="collapsSubDocs()"
        >
          {{ singleDocument?.file?.originalName }}
        </p>
      </div>
      <div class="d-flex justify-content-center" *ngIf="docModel">
        <span
          *ngIf="
            singleDocument.file?.matchingDocs?.length > 0 && !collapsStatus
          "
          class="sub-doc-num"
          >DOCS: {{ singleDocument.file?.matchingDocs?.length }}</span
        >
        <div
          *ngFor="
            let matchingDoc of singleDocument.file?.matchingDocs;
            let i = index
          "
          class="parent-ellipsis"
        >
          <div
            *ngIf="!singleDocument.mergedDocs && matchingDoc.collaps"
            [@inOutAnimation]
            class="collaps-box"
          >
            <div id="pointer"></div>
            <div class="sub-doc text-ellipsis" [ngbTooltip]="redFlagTemplate">
              <ng-template #redFlagTemplate>
                <div class="sub-doc-info">
                  <div *ngIf="matchingDoc.collaps">
                    {{ matchingDoc.originalName }}
                  </div>
                  <span class="file-type-sub file-type">
                    <span
                      class="kat-sub-sent"
                      *ngIf="
                        matchingDoc.jobStatus == 'completed' &&
                        matchingDoc.sent &&
                        docModel.isModelContainerRjesenje
                      "
                    ></span>
                    <span
                      class="kat-sub-not-sent"
                      *ngIf="
                        matchingDoc.jobStatus == 'completed' &&
                        !matchingDoc.sent &&
                        docModel.isModelContainerRjesenje
                      "
                    ></span>
                    <span class="sub-date">{{
                      matchingDoc.createdAt | date : "dd/MM/yy"
                    }}</span>
                  </span>
                  <div class="sub-dco-type">
                    {{ matchingDoc?.type }}
                  </div>
                </div>
              </ng-template>
              <a
                (click)="openMatchingDoc(matchingDoc)"
                [ngClass]="{
                  'file-not-ready':
                    (matchingDoc.hasOwnProperty('confidenceStatus') &&
                      matchingDoc?.confidenceStatus === false) ||
                    matchingDoc.checked,
                  'file-ready':
                    (matchingDoc.hasOwnProperty('confidenceStatus') &&
                      matchingDoc?.confidenceStatus === false) ||
                    matchingDoc.checked
                }"
                class="sub-doc-name"
                >{{ matchingDoc.originalName }}</a
              >
            </div>
          </div>
        </div>
      </div>
      <div class="align-items-center info-container" *ngIf="docModel">
        <p>
          <span
            [ngClass]="
              this.singleDocument.prev?.fileName ? '' : 'disable-next-prev'
            "
            class="doc-prev typcn typcn-chevron-left"
            (click)="
              !this.singleDocument.prev?.fileName ? null : changeDoc(false)
            "
          ></span>
          MODEL: {{ docModel.modelName }} - {{ docModel.modelVersion }} @
          {{ singleDocument.file.createdAt | date : "MMM d, y HH:mm" }}
          <span
            [ngClass]="
              this.singleDocument.next?.fileName ? '' : 'disable-next-prev'
            "
            class="doc-next typcn typcn-chevron-right"
            (click)="
              !this.singleDocument.next?.fileName ? null : changeDoc(true)
            "
          ></span>
        </p>
      </div>
    </div>
  </div>

  <div id="search-box">
    <lib-document-actions
      [documentConfig]="documentConfig"
      [document]="document"
      class="document-actions-container"
      [documentActionsSrc]="documentActionsSrc"
      id="viewer"
      [isOpenVar]="isOpenVar"
      (isOpen)="isOpenEmmit($event)"
    ></lib-document-actions>
    <lib-search-modal
      (pageSearch)="emitPageSearch($event)"
      class="search-component"
      (searchTextInDoc)="emitSearchedText($event)"
    >
    </lib-search-modal>
    <lib-document-actions-left
      [inProjects]="inProjects"
      (downloadExcelEvent)="downloadExcel($event)"
      [editable]="documentConfig?.editable"
      (downloadDocument)="downloadDocument($event)"
      (downloadParagraphs)="downloadParagraphs($event)"
      class="document-actions-left-container"
      id="viewer"
      [documentActionsSrc]="documentActionsSrc"
      [document]="document"
      [singleDocument]="singleDocument"
      [docModel]="docModel"
      [params]="params"
      (exportMonthlyStat)="exportMonthlyStatEventEmmiter($event)"
    ></lib-document-actions-left>
  </div>

  <div class="d-flex align-items-center flex-column" id="doc-box">
    <lib-document
      (naturalDimensions)="emitImgNaturalDimension($event)"
      [documentConfig]="documentConfig"
      #document
      (triggerTextLayer)="triggerTextLayerCreation($event)"
      (pageSearch)="emitPageSearch($event)"
      class="document-viewer-container"
    ></lib-document>
  </div>

  <lib-page-navigation
    [documentActionsSrc]="documentActionsSrc"
    [triggeredModalIsOpen]="triggeredModalIsOpen"
    [singleDocument]="singleDocument"
    [reorderFinished]="reorderFinished"
    (downloadDocumentEvent)="downloadDocument($event)"
    [documentsList]="
      singleDocument.originalMergedDocs
        ? singleDocument.originalMergedDocs
        : [singleDocument]
    "
    (triggerTextLayer)="triggerTextLayerCreation($event)"
    (reorderDocumentEvent)="triggerReorderDocument($event)"
    (separateDocumentEvent)="triggerSeparateDocument($event)"
    (triggerPagesReorder)="triggerPagesReorder($event)"
    (triggerSplitDocument)="triggerSplitDocument($event)"
    (openTriggeredEmittrt)="openTriggered($event)"
    class="document-page-navigation-container"
  ></lib-page-navigation>
</div>
<lib-info-modal></lib-info-modal>
