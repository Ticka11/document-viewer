<div
  class="viewer-container"
  [ngStyle]="{ 'justify-content': totalPages > 1 ? 'space-between' : 'center' }"
  id="viewer-container"
>
  <div id="info-box">
    <div class="col-12 col-sm-12 p-0">
      <div class="d-flex justify-content-center" *ngIf="docModel">
        <ng-template #orgDocInfo>
          <div class="sub-doc-info p-0">
            <div *ngIf="collapsStatus">
              {{ singleDocument?.file?.originalName }}
            </div>
            <span class="file-type-sub file-type">
              <span
                class="kat-sub-sent"
                *ngIf="
                  singleDocument?.file?.sent &&
                  docModel.isModelContainerRjesenje
                "
              ></span>
              <span
                class="kat-sub-not-sent"
                *ngIf="
                  !singleDocument?.file?.sent &&
                  docModel.isModelContainerRjesenje
                "
              ></span>
              <span class="sub-date">{{
                singleDocument?.file?.createdAt | date: "dd/MM/yy"
              }}</span>
            </span>
            <div class="sub-dco-type">
              {{ singleDocument?.file.type }}
            </div>
            <div class="mt-1">
              <div *ngFor="let sentance of singleDocument.file.toFix">
                <span class="mt-2"> {{ sentance }} </span>
              </div>
            </div>
          </div>
        </ng-template>

        <ng-container *ngIf="singleDocument.originalMergedDocs">
          <div class="model-info p-0 parent-ellipsis">
            <span
              (click)="filterPattern(doc.file)"
              [ngbTooltip]="singleDocInfo"
              *ngFor="
                let doc of singleDocument.originalMergedDocs;
                last as isLast
              "
            >
              <span
                class="document-name"
                [ngClass]="
                  doc.file.filterValue || activeFileId === doc.file._id
                    ? 'active-filter'
                    : 'inactive-filter'
                "
              >
                <div
                  class="underlined"
                  [ngStyle]="{
                    'border-bottom':
                      doc.colorValue === openedDocColor
                        ? '4px solid ' + doc.colorValue
                        : '4px solid ' + doc.colorValue + '54'
                  }"
                >
                  {{ doc?.file?.originalName | stringEllipsis: 15 }}
                </div>
              </span>
              <span *ngIf="!isLast"> & </span>

              <!-- tooltip template -->
              <ng-template #singleDocInfo>
                <div class="sub-doc-info">
                  <div *ngIf="collapsStatus">
                    {{ doc?.file?.originalName }}
                  </div>
                  <span class="file-type-sub file-type">
                    <span
                      class="kat-sub-sent"
                      *ngIf="
                        doc?.file?.sent && docModel.isModelContainerRjesenje
                      "
                    ></span>
                    <span
                      class="kat-sub-not-sent"
                      *ngIf="
                        !doc?.file?.sent && docModel.isModelContainerRjesenje
                      "
                    ></span>
                    <span class="sub-date">{{
                      doc?.file?.createdAt | date: "dd/MM/yy"
                    }}</span>
                  </span>
                  <div class="sub-dco-type">
                    {{ doc?.file.type }}
                  </div>
                </div>
              </ng-template>
            </span>
          </div>
        </ng-container>

        <div class="model-info p-0 parent-ellipsis" [ngbTooltip]="orgDocInfo">
          <p
            *ngIf="!singleDocument.mergedDocs"
            [ngClass]="{
              'red-flag': documentConfig?.flag == 'red',
              'green-flag': documentConfig?.flag == 'green'
            }"
            class="traning-model-name text-ellipsis"
            (click)="collapsSubDocs()"
          >
            {{ singleDocument?.file?.originalName }}
          </p>
        </div>
        <span
          *ngIf="
            singleDocument.file?.matchingDocs?.length > 0 && !collapsStatus
          "
          class="sub-doc-num"
          >DOCS: {{ singleDocument.file?.matchingDocs?.length }}</span
        >
        <div
          *ngFor="
            let matchingDoc of singleDocument.file?.matchingDocs;
            let i = index
          "
          class="parent-ellipsis"
        >
          <div
            *ngIf="!singleDocument.mergedDocs && matchingDoc.collaps"
            [@inOutAnimation]
            class="collaps-box"
          >
            <div id="pointer"></div>
            <div class="sub-doc text-ellipsis" [ngbTooltip]="redFlagTemplate">
              <ng-template #redFlagTemplate>
                <div class="sub-doc-info">
                  <div *ngIf="matchingDoc.collaps">
                    {{ matchingDoc.originalName }}
                  </div>
                  <span class="file-type-sub file-type">
                    <span
                      class="kat-sub-sent"
                      *ngIf="
                        matchingDoc.jobStatus == 'completed' &&
                        matchingDoc.sent &&
                        docModel.isModelContainerRjesenje
                      "
                    ></span>
                    <span
                      class="kat-sub-not-sent"
                      *ngIf="
                        matchingDoc.jobStatus == 'completed' &&
                        !matchingDoc.sent &&
                        docModel.isModelContainerRjesenje
                      "
                    ></span>
                    <span class="sub-date">{{
                      matchingDoc.createdAt | date: "dd/MM/yy"
                    }}</span>
                  </span>
                  <div class="sub-dco-type">
                    {{ matchingDoc?.type }}
                  </div>
                </div>
              </ng-template>
              <a
                (click)="openMatchingDoc(matchingDoc)"
                [ngClass]="{
                  'file-not-ready':
                    (matchingDoc.hasOwnProperty('confidenceStatus') &&
                      matchingDoc?.confidenceStatus === false) ||
                    matchingDoc.checked,
                  'file-ready':
                    (matchingDoc.hasOwnProperty('confidenceStatus') &&
                      matchingDoc?.confidenceStatus === false) ||
                    matchingDoc.checked
                }"
                class="sub-doc-name"
                >{{ matchingDoc.originalName }}</a
              >
            </div>
          </div>
        </div>
      </div>
      <div class="align-items-center info-container" *ngIf="docModel">
        <p>
          <span
            [ngClass]="
              this.singleDocument.prev.fileName ? '' : 'disable-next-prev'
            "
            class="doc-prev typcn typcn-chevron-left"
            (click)="
              !this.singleDocument.prev.fileName ? null : changeDoc(false)
            "
          ></span>
          MODEL: {{ docModel.modelName }} - {{ docModel.modelVersion }} @
          {{ singleDocument.file.createdAt | date: "MMM d, y HH:mm" }}
          <span
            [ngClass]="
              this.singleDocument.next.fileName ? '' : 'disable-next-prev'
            "
            class="doc-next typcn typcn-chevron-right"
            (click)="
              !this.singleDocument.next.fileName ? null : changeDoc(true)
            "
          ></span>
        </p>
      </div>
    </div>
  </div>

  <div id="search-box">
    <lib-document-actions
      [documentConfig]="documentConfig"
      [document]="document"
      class="document-actions-container"
      [documentActionsSrc]="documentActionsSrc"
      id="viewer"
    ></lib-document-actions>
    <lib-search-modal
      (pageSearch)="emitPageSearch($event)"
      class="search-component"
      (searchTextInDoc)="emitSearchedText($event)"
    >
    </lib-search-modal>
    <lib-document-actions-left
      [editable]="documentConfig?.editable"
      (downloadDocument)="downloadDocument($event)"
      (downloadParagraphs)="downloadParagraphs($event)"
      class="document-actions-left-container"
      id="viewer"
      [documentActionsSrc]="documentActionsSrc"
    ></lib-document-actions-left>
  </div>

  <div class="d-flex align-items-center flex-column" id="doc-box">
    <lib-document
      (naturalDimensions)="emitImgNaturalDimension($event)"
      [documentConfig]="documentConfig"
      #document
      (triggerTextLayer)="triggerTextLayerCreation($event)"
      (pageSearch)="emitPageSearch($event)"
      class="document-viewer-container"
    ></lib-document>
  </div>

  <lib-page-navigation
    [documentActionsSrc]="documentActionsSrc"
    [singleDocument]="singleDocument"
    (downloadDocumentEvent)="downloadDocument($event)"
    [documentsList]="singleDocument.originalMergedDocs"
    (triggerTextLayer)="triggerTextLayerCreation($event)"
    (reorderDocumentEvent)="triggerReorderDocument($event)"
    (separateDocumentEvent)="triggerSeparateDocument($event)"
    (triggerPagesReorder)="triggerPagesReorder($event)"
    class="document-page-navigation-container"
  ></lib-page-navigation>
</div>
<lib-info-modal></lib-info-modal>
